<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>è®€æ›¸è¨ˆç•«</title>
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    body { transition: background 0.3s ease; }

    /* èƒŒæ™¯è‰² */
    .bg-default { background-color: #f3e9dd; }
    .bg-red { background-color: #fde2e2; }
    .bg-orange { background-color: #fff1d6; }
    .bg-green { background-color: #e6f4ea; }
    .bg-blue { background-color: #e8f1fd; }
    .bg-purple { background-color: #f1e8fd; }
    .bg-rainbow {
      background: linear-gradient(
        135deg,
        #fde2e2,
        #fff1d6,
        #e6f4ea,
        #e8f1fd,
        #f1e8fd
      );
    }

    .earth-btn { background-color: #a47551; }
    .earth-btn:hover { background-color: #8c5f3c; }

    .calendar-grid {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 8px;
    }

    .calendar-cell {
      background: #fff;
      min-height: 120px;
      padding: 8px;
      border-radius: 10px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.08);
    }

    .task-block {
      background: #ffe8c8;
      padding: 6px 8px;
      border-radius: 6px;
      margin-top: 6px;
      font-size: 14px;
    }

    .label-muted { color: #6b5a4a; font-size: 14px; }
  </style>
</head>

<body class="p-6 bg-default">

<h1 class="text-3xl font-bold mb-4">ğŸ“˜ è®€æ›¸è¨ˆç•«</h1>

<!-- èƒŒæ™¯é¡è‰²é¸æ“‡ -->
<div class="bg-white p-4 rounded-xl shadow mb-4">
  <h2 class="text-xl font-bold mb-2">ğŸ¨ èƒŒæ™¯é¡è‰²</h2>
  <select id="bgColorSelect" class="border p-2 rounded w-full">
    <option value="default">ç±³è‰²ï¼ˆé è¨­ï¼‰</option>
    <option value="red">ç´…è‰²</option>
    <option value="orange">æ©˜è‰²</option>
    <option value="green">ç¶ è‰²</option>
    <option value="blue">è—è‰²</option>
    <option value="purple">ç´«è‰²</option>
    <option value="rainbow">å½©è‰²</option>
  </select>
</div>

<!-- è€ƒè©¦æ—¥æœŸ -->
<div class="bg-white p-4 rounded-xl shadow mb-4">
  <h2 class="text-xl font-bold mb-2">è€ƒè©¦æ—¥æœŸ</h2>
  <input id="examDate" type="date" class="border p-2 rounded w-full" />
</div>

<!-- æ¯é€±å¯è®€æ›¸æ™‚é–“ -->
<div class="bg-white p-4 rounded-xl shadow mb-4">
  <h2 class="text-xl font-bold mb-2">æ¯é€±å¯è®€æ›¸æ™‚é–“</h2>

  <div class="grid grid-cols-1 gap-3">
    <div><b>æ˜ŸæœŸä¸€</b><div class="flex gap-2"><input id="monStart" type="time" class="border p-2 rounded w-1/2"><input id="monEnd" type="time" class="border p-2 rounded w-1/2"></div></div>
    <div><b>æ˜ŸæœŸäºŒ</b><div class="flex gap-2"><input id="tueStart" type="time" class="border p-2 rounded w-1/2"><input id="tueEnd" type="time" class="border p-2 rounded w-1/2"></div></div>
    <div><b>æ˜ŸæœŸä¸‰</b><div class="flex gap-2"><input id="wedStart" type="time" class="border p-2 rounded w-1/2"><input id="wedEnd" type="time" class="border p-2 rounded w-1/2"></div></div>
    <div><b>æ˜ŸæœŸå››</b><div class="flex gap-2"><input id="thuStart" type="time" class="border p-2 rounded w-1/2"><input id="thuEnd" type="time" class="border p-2 rounded w-1/2"></div></div>
    <div><b>æ˜ŸæœŸäº”</b><div class="flex gap-2"><input id="friStart" type="time" class="border p-2 rounded w-1/2"><input id="friEnd" type="time" class="border p-2 rounded w-1/2"></div></div>
    <div><b>æ˜ŸæœŸå…­</b><div class="flex gap-2"><input id="satStart" type="time" class="border p-2 rounded w-1/2"><input id="satEnd" type="time" class="border p-2 rounded w-1/2"></div></div>
    <div><b>æ˜ŸæœŸæ—¥</b><div class="flex gap-2"><input id="sunStart" type="time" class="border p-2 rounded w-1/2"><input id="sunEnd" type="time" class="border p-2 rounded w-1/2"></div></div>
  </div>
</div>

<!-- ç§‘ç›®è¨­å®š -->
<div class="bg-white p-4 rounded-xl shadow mb-4">
  <h2 class="text-xl font-bold mb-2">ç§‘ç›®è¨­å®š</h2>
  <input id="subjectInput" class="border p-2 rounded w-full mb-2" placeholder="ä¾‹å¦‚ï¼šæ•¸å­¸, è‹±æ–‡, åœ‹æ–‡">
  <input id="weakSubject" class="border p-2 rounded w-full mb-2" placeholder="æœ€å¼±ç§‘ç›®">
  <label class="label-muted">è®€å¤šä¹…ä¼‘æ¯ï¼ˆåˆ†é˜ï¼‰</label>
  <input id="breakEvery" type="number" value="50" class="border p-2 rounded w-full mb-2">
  <label class="label-muted">ä¼‘æ¯å¤šä¹…ï¼ˆåˆ†é˜ï¼‰</label>
  <input id="breakLength" type="number" value="10" class="border p-2 rounded w-full">
</div>

<button id="btnGenerate" class="earth-btn text-white w-full p-3 rounded-lg mb-4 text-lg font-bold">
  ç”Ÿæˆè®€æ›¸æ—¥ç¨‹è¡¨
</button>

<div class="bg-white p-4 rounded-xl shadow">
  <h2 class="text-xl font-bold mb-4">ğŸ“… è¡Œäº‹æ›†</h2>
  <div id="calendar" class="calendar-grid"></div>
</div>

<!-- Modal -->
<div id="modal" class="fixed inset-0 bg-black/40 flex items-center justify-center hidden">
  <div class="bg-white p-6 rounded-xl w-72 text-center">
    <p id="modalMsg" class="text-lg mb-4"></p>
    <button onclick="closeModal()" class="earth-btn text-white px-4 py-2 rounded-lg">å¥½çš„</button>
  </div>
</div>

<script>
/* ===== Modal ===== */
function showModal(msg){
  modalMsg.innerText = msg;
  modal.classList.remove('hidden');
}
function closeModal(){
  modal.classList.add('hidden');
}

/* ===== Background Color ===== */
const bgSelect = document.getElementById('bgColorSelect');
const bgClasses = {
  default: 'bg-default',
  red: 'bg-red',
  orange: 'bg-orange',
  green: 'bg-green',
  blue: 'bg-blue',
  purple: 'bg-purple',
  rainbow: 'bg-rainbow'
};

bgSelect.addEventListener('change', () => {
  Object.values(bgClasses).forEach(c => document.body.classList.remove(c));
  document.body.classList.add(bgClasses[bgSelect.value]);
});

/* ===== Calendar Logic ===== */
const calendarEl = document.getElementById('calendar');
const btnGenerate = document.getElementById('btnGenerate');

const weekInputs = {
  0:{start:sunStart,end:sunEnd},
  1:{start:monStart,end:monEnd},
  2:{start:tueStart,end:tueEnd},
  3:{start:wedStart,end:wedEnd},
  4:{start:thuStart,end:thuEnd},
  5:{start:friStart,end:friEnd},
  6:{start:satStart,end:satEnd}
};

btnGenerate.onclick = () => {
  const subjects = subjectInput.value.split(',').map(s=>s.trim()).filter(Boolean);
  if(!examDate.value || subjects.length===0){
    showModal('è«‹å¡«å¯«å®Œæ•´è³‡æ–™');
    return;
  }

  calendarEl.innerHTML = '';
  const start = new Date();
  const end = new Date(examDate.value);
  const weak = weakSubject.value;

  for(let d=new Date(start); d<=end; d.setDate(d.getDate()+1)){
    const input = weekInputs[d.getDay()];
    if(!input.start.value || !input.end.value) continue;

    let [sh,sm] = input.start.value.split(':').map(Number);
    let [eh,em] = input.end.value.split(':').map(Number);
    let minutes = eh*60+em - (sh*60+sm);
    if(minutes<=0) continue;

    const cell = document.createElement('div');
    cell.className='calendar-cell';
    cell.innerHTML=`<b>${d.toISOString().split('T')[0]}</b>`;

    let cur = sh*60+sm, i=0;
    while(minutes>0){
      const sub = subjects[i%subjects.length];
      const len = sub===weak ? 100 : 50;
      const endM = cur+len;
      const block=document.createElement('div');
      block.className='task-block';
      block.innerText=
        `${String(Math.floor(cur/60)).padStart(2,'0')}:${String(cur%60).padStart(2,'0')}â€“`+
        `${String(Math.floor(endM/60)).padStart(2,'0')}:${String(endM%60).padStart(2,'0')} ${sub}`;
      cell.appendChild(block);
      cur=endM+10;
      minutes-=len+10;
      i++;
    }
    calendarEl.appendChild(cell);
  }

  showModal('è®€æ›¸æ—¥ç¨‹è¡¨å·²ç”Ÿæˆï¼');
};
</script>

</body>
</html>
